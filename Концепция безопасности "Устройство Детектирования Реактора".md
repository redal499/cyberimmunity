# Концепция безопасности "Устройство Детектирования Реактора"

## Краткое описание проектируемой системы

![1](images/fPBFwn916CRlyrUyV4yATWcwH8HHzuBDItGPT0bHPsLsFKG4AeI41oC4eKDXdeErTcXRS_qNtlcFUcRM7thEW_lklf_dsUSPLZJZHEfaDEYBkDTLGwdbW6GxYNIGlEs752VTTcyWrTLMX-r4gZTOlXE4duv6glCqqYhKTF-1U2-4rzCTBpcrKplZd0lExqZ658GgZdGipXwWDdO2Qimb_t4J.png)

**Устройство Детектирования (УД)** предназначено для обработки сигналов от датчиков реакторной установки.
Ключевые функции:
1.  **Автоматическое срабатывание:** При превышении заданных пороговых значений входящих сигналов, УД автоматически формирует и передает команду на срабатывание в Систему Управления Защитой (СУЗ) реактора.
2.  **Передача данных:** УД передает обработанные данные о параметрах в Автоматизированную Систему Управления Технологическим Процессом (АСУ ТП) АЭС для мониторинга, анализа и архивирования.
3.  **Поддержка административного срабатывания:** Данные, переданные в АСУ ТП, могут использоваться оператором для принятия решения о ручной (административной) выдаче команды в СУЗ.

## Ключевые ценности, ущербы, неприемлемые события

| Ценность                                     | Негативное событие                                                                                                                                                                                                                         | Оценка ущерба | Комментарий                                                      |
| :------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------ | :--------------------------------------------------------------- |
| **Корректная работа защиты реактора**        | **Команда в СУЗ не выдана, когда была необходима** (пропуск события)                                                                                                                                                                       | **Высокий**   | Риск развития аварийной ситуации.                                |
| **Корректная работа защиты реактора**        | **Команда в СУЗ выдана ложно** (без реальной необходимости)                                                                                                                                                                               | **Высокий**   | Ложное срабатывание защиты, останов реактора, экономический ущерб. |
| **Данные** (обрабатываемые, хранимые, передаваемые УД) | Нарушение **целостности** (сигнал изменен), потеря **аутентичности**, сигнал **не обработан** (потерян внутри УД), **не передан** в АСУ ТП.                                                                                            | **Высокий**   | Некорректная работа автоматики (СУЗ), неверные решения оператора. |
| **События в журнале**                        | Событие не зарегистрировано, событие искажено, зарегистрировано ложное событие, событие удалено.                                                                                                                                             | **Средний**   | Сложности при расследовании инцидентов, невозможность анализа.     |
| **Целостность и доступность ПО УД** (Обновление) | Применена неаутентичная прошивка. <br> Аутентичная прошивка привела к: <br> - "окирпичиванию" устройства <br> - возможности установки любой прошивки в будущем <br> - непрохождению внешних тестов <br> - отсутствию реакции на негативные тесты | **Средний**   | Потеря функциональности, уязвимости, затраты на восстановление. |

## Контекст

![2](images/RLCzRnD14EttLun2OnUcGA9128MF4WaaumQbMTaNnugzP-sTXH12YYzyW0mAHQGWYe19ZNHnE32EF_x2x3_YpHx-E14NlhcPzzxClDtRZc9jurwdhQBzbkbggpkawt5eg_7pTa1HtAhlTxJPgDgW7clJHF658lnis3ED-w4rWQKRDtqgsjEDy5dBD6bNjwD0lLJAQz8M7tFg4lUMnppXyHRf.png)

## Основные функциональные сценарии

![3](images/ZLJDJjj06BpxARQSGAA8_lHILOXAlRSIvLBrOe7L8a4IEU5EWlfJjH8Sh5Br04fphcIIc1X2p2kCtwWpseqiEqbR3jQoEpFVVFFjPhFPyiFMuS6-Tw_rFZW8J6FVtwjvdh_JgeVcPIC8VIty9jUc7ku6eNcmxZN8sTlPQ_Yrbbd2ARhe6Vp2XU7wDxfBmZ_Vsdxzob4ULYczl9rtyYDakDOA.png)

## Высокоуровневая архитектура

![4](images/Безымянный.png)

### Описание подсистем

| Название                                 | Назначение                                                                                                                            |
| :--------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------ |
| 1. Интерфейс Датчиков                    | Прием и первичная обработка (фильтрация, нормализация) сигналов от физических датчиков.                                               |
| 2. Система Обработки Сигналов            | Основная логика анализа сигналов, сравнение с порогами, выявление условий для срабатывания защиты.                                   |
| 3. Система Принятия Решений и Управления | Формирование команды на срабатывание для СУЗ на основе решения Системы Обработки. Управление режимами работы УД.                      |
| 4. Интерфейсы Вывода (СУЗ, АСУ ТП)       | Передача команды в СУЗ по соответствующему интерфейсу. Передача обработанных данных и статусной информации в АСУ ТП.                  |
| 5. Система Диагностики и Журналирования  | Мониторинг состояния компонентов УД, самодиагностика, ведение защищенного журнала событий (срабатывания, ошибки, действия, изменения). |

## Расширенные диаграммы функциональных сценариев

*Иллюстрация взаимодействия подсистем во время автоматического срабатывания*

![5](images/bLLTQnD157tVNp7soO9AFrgLFfIA8WY2XTeN4IIqImsqks5tyvwsOfKKMYHO4RJ6FWlRhOlJZqp-mfb_v9tRdIGxJGh9GxBSkVVSSyyzErcAaqgKrBSslJl9Ut_B5xNDIZNml1f5gslLMYL8n0GEqSQ9m6yS2th-W_Q4gCJYoShgwsKHHkj-9AQdd18gm16dhQo-AP9cdAJf1mBVqD4xo7L3.png)

## Цели и предположения безопасности

### Цели безопасности (ЦБ)

1.  **ЦБ1 (Корректность срабатывания):** УД должно генерировать и передавать команду в СУЗ *тогда и только тогда*, когда легитимные сигналы от датчиков соответствуют критериям срабатывания, определенным в конфигурации УД. (Покрывает риск ложного и пропуска срабатывания).
2.  **ЦБ2 (Целостность и аутентичность Данных):** Данные, передаваемые из УД в АСУ ТП, должны быть целостными и аутентичными (не искажены, источник подтвержден). Сигналы внутри УД должны сохранять целостность на всех этапах обработки.
3.  **ЦБ3 (Целостность и доступность Журнала):** Журнал событий должен быть защищен от несанкционированного изменения, удаления и быть доступным для авторизованного анализа. События должны регистрироваться корректно и своевременно.
4.  **ЦБ4 (Безопасное обновление и Конфигурирование):** Должна быть обеспечена возможность установки только аутентичного и целостного ПО и конфигурации. Процесс обновления не должен приводить к нарушению функционирования УД или созданию уязвимостей.

### Предположения безопасности

1.  **ПБ1 (Физическая безопасность):** Физический доступ к УД и подключенным линиям связи (датчики, СУЗ, АСУ ТП) контролируется и защищен в рамках общей физической безопасности АЭС.
2.  **ПБ2 (Безопасность смежных систем):** Предполагается, что СУЗ корректно обрабатывает полученную от УД команду. АСУ ТП и действия оператора АСУ ТП находятся вне скоупа безопасности самого УД, но УД должно предоставлять им корректные данные. Безопасность самих датчиков (защита от подмены сигнала до УД) предполагается обеспеченной.
3.  **ПБ3 (Надежность электропитания):** Предполагается наличие надежного и бесперебойного электропитания для УД.

### Таблица соотнесения ценностей, неприемлемых событий и целей безопасности

| Ценность                                     | Негативное событие                                                                                                                                                                                                                         | Оценка ущерба | Цель(и) безопасности |
| :------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------ | :------------------- |
| Корректная работа защиты реактора        | Команда в СУЗ не выдана, когда была необходима                                                                                                                                                                       | Высокий       | **ЦБ1**              |
| Корректная работа защиты реактора        | Команда в СУЗ выдана ложно                                                                                                                                                                               | Высокий       | **ЦБ1**              |
| Данные                                     | Нарушение целостности, потеря аутентичности, сигнал не обработан, не передан в АСУ ТП.                                                                                                                             | Высокий       | **ЦБ1, ЦБ2**         |
| События в журнале                        | Событие не зарегистрировано, искажено, ложное событие, удалено.                                                                                                                                             | Средний       | **ЦБ3**              |
| Целостность и доступность ПО УД        | Неаутентичная прошивка, "окирпичивание", потеря защиты при обновлении, нарушение тестов.                                                                                                                           | Средний       | **ЦБ4**              |

## Негативные сценарии

### Негативный сценарий №1: Искажение данных на входе или выходе (Нарушение ЦБ1, ЦБ2)

![6](images/bLLTJnDH47s_l-8ABss3bGzGqnY2qPYOa4X4NWo9QM25ZMMtsIu-0nKbAR74u4TC5AlF9gMuiFsW_8Mv_yWp-v6zkoacljZrtfapvvoPEopKtBBZRczLn0rtqzWoPBLIDYqXgZWrryngsNBb61rHYtv9-aad4j-_gJKcopLvVtdbsPAqdNN3aLEJcHGaqESWR7dbUHGqdGcQAahwGfTgZpor.png)

### Негативный сценарий №2: Компрометация логики обработки (Нарушение ЦБ1)

![7](images/dLPlJzDU57xVJt61Dspv_SP_DOin68s92Ob4v8qXCGjKQ1pjqXLVCwQYcN58K8namCGO4sDInWhTs9-lSEutyhbtRMthPeWlo6vlptsUSvxpd5jcyrR6j3RMiygGjQQkgooNpMYwekImgorhkOnkiM7QeIgTCFf2HmphdrGTPfaykxsm-6YU6UQAQhA9yTWH7A1z6RQm-DWBcem5JQGOVQ8s.png)

## Политика архитектуры

### Версия 1 (Начальная)

На основе анализа рисков и целей безопасности, назначаем начальные уровни доверия компонентам.

![8](images/ПолитикаАрхитектуры.png)

| Домен безопасности                       | Уровень доверия                  | Оценка сложности и размера домена | Обоснование                                                                                                                              |
| :--------------------------------------- | :------------------------------- | :-------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------- |
| 1. Интерфейс Датчиков                    | Недоверенный                     | MM                                | Компрометация может привести к неверным входным данным, но ЦБ1 зависит от последующей обработки. Нарушает ЦБ2.                           |
| 2. Система Обработки Сигналов            | **Доверенный, повышающий целостность и контроль**                     | CL                                | **Критический компонент.** Ошибка/компрометация напрямую нарушает **ЦБ1** (определение условия срабатывания).                             |
| 3. Система Принятия Решений и Управления | **Доверенный**                     | CL                                | **Критический компонент.** Ошибка/компрометация напрямую нарушает **ЦБ1** (формирование команды). Влияет на **ЦБ4** (управление).        |
| 4. Интерфейсы Вывода (СУЗ, АСУ ТП)       | **Доверенный**                     | SS                                | **Критический компонент.** Отвечает за *доставку* критической команды (ЦБ1) и целостность данных для АСУ ТП (ЦБ2).                     |
| 5. Система Диагностики и Журналирования  | Доверенный                     | SM                                | Компрометация нарушает **ЦБ3**, но напрямую не вызывает ложного/пропуска срабатывания (ЦБ1). Затрудняет анализ инцидентов.          |

*Проблема V1:* Большая поверхность атаки на доверенные компоненты. Сложность этих компонентов затрудняет их верификацию и обеспечение безопасности.

### Версия 2 (Кибериммунный подход)

Вводим **Монитор Безопасности (МБ)**, который становится ядром доверенной базы. Его задача - контролировать взаимодействие между основными компонентами и проверять критические решения перед их исполнением.

![9](images/ПолитикаАрхитектуры2.png)

| Домен безопасности                       | Уровень доверия                                   | Оценка сложности и размера домена | Обоснование                                                                                                                                                              |
| :--------------------------------------- | :------------------------------------------------ | :-------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1. Интерфейс Датчиков                    | Недоверенный                                      | MM                                | Работает под контролем МБ. Нарушение ЦБ2 блокируется МБ.                                                                                                                 |
| 2. Система Обработки Сигналов            | Недоверенный                                      | CL                                | Работает под контролем МБ. Попытка нарушения ЦБ1 (неверная обработка) блокируется МБ при проверке решения.                                                                 |
| 3. Система Принятия Решений и Управления | **Доверенный**                                      | CL                                | Работает под контролем МБ. Попытка нарушения ЦБ1 (неверное решение/команда) или ЦБ4 (неверная конфигурация) блокируется МБ.                                                     |
| 4. Интерфейсы Вывода (СУЗ, АСУ ТП)       | Недоверенный                                      | SS                                | Работает под контролем МБ. Попытка нарушения ЦБ1 (отправка неавторизованной команды) или ЦБ2 (искажение данных) блокируется МБ.                                                 |
| 5. Система Диагностики и Журналирования  | Недоверенный                                      | SM                                | Работает под контролем МБ. Попытка нарушения ЦБ3 может быть частично проконтролирована МБ (например, контроль потока логов).                                                   |
| **6. Монитор Безопасности (МБ)**         | **Доверенный, повышающий целостность и контроль** | **MM**                            | **Ядро доверенной базы.** Реализует политику безопасности: проверяет взаимодействия, валидирует критические данные и решения (ЦБ1, ЦБ2, ЦБ4). Малый размер облегчает верификацию. |

*Преимущества V2:* Значительное сокращение доверенной вычислительной базы до двух компонентов (Монитор Безопасности и Система принятия решений) с минимальной сложностью (SS). Остальные компоненты становятся недоверенными, их потенциально некорректное поведение контролируется МБ, что повышает общую безопасность и устойчивость системы к атакам и сбоям. Реализует принципы кибериммунитета.

## Прототип системы

*На данном этапе прототип не разрабатывается, но здесь могла бы быть ссылка на него.*
